# -ipv6-
校园教育网ipv6免流原理（基于北工大校园网，非教程）


本篇仅是基于个人的浅显理解撰写，如有错误，欢迎指正。



1.IPv6介绍

IPv6，Internet Protocol Version 6，互联网协议第6版，用于替代IPv4的下一代IP协议。

IPv6的地址长度为128位，格式为X:X:X:X:X:X:X:X。

本校以及其他校园网ipv6免费的学校，所用的ipv6均为教育网ipv6，特征是ip地址都是以2001:da8:开头。

ipv6相较于ipv4，具有诸多优点，如地址充足，所分配的ipv6地址几乎都是公网ip，而非NAT，这点对于与朋友联机打游戏、串流等或许有帮助。

教育网ipv6，相较于普通ipv6，更是具有诸多优点，如使用人数少、带宽大、国际流量响应更好等等。

目前国家大力推进ipv6发展，越来越多的网站和app开始支持ipv6，或许在不远的将来我们不需要借助工具即可实现免流。

关于ipv6的更多知识，我在这里不多赘述，感兴趣的同学可以自行搜索。这里我主要说一下ipv6免流的原理。



2.ipv6免流

免流，免费流量，即使用网络时，不消耗自身流量。

ipv6免流，即使用ipv6网络时不消耗流量，是基于本校的ipv6本就是不计费的情况下进行的。以下摘自"北工大信息化"公众号发布的《校园网计费策略》:

”校园网计费策略只对IPv4入流量进行计费，出流量不计费。访问校外IPv6资源不计费，但需要登录计费系统认证后访问。“

ipv4流量，即我们平常所说的10元60G 20元120G 30元180G的校园网套餐流量。这里的“入流量”指的是下行流量，即互联网发送给你的流量，比如下载内容、观看在线视频等等所消耗的流量。

这里涉及到一个鲜为人知的小tips，校园网不管是对ipv4还是对ipv6的"出流量"都不会计费，即你发送给互联网的流量（上传）不计费，最常见的一个例子就是，你使用校园网在微信发送一个文件给你的好友，那么你这边是不会有流量计费的。

如上文所见，ipv6无论是"出流量"还是"入流量"都不会有计费，那么问题来了，为什么不直接使用ipv6呢？这样不就直接免流了吗？为什么还要使用工具呢？

原因是大多数互联网流量对ipv6的支持度不高，其表现为：

①当你的网络ipv4和ipv6都存在。由于大多数网站和app都不支持ipv6流量的缘故，导致只能走ipv4。即使网站和app支持ipv6，很多情况下也会默认走ipv4，故而不能免流。

②当你的网络是纯ipv6环境（即有线网只认证ipv6）。你会发现，同样由于不支持ipv6流量的缘故，绝大多数网站以及app都无法使用。

为了方便理解，我们可以形象地把流量上网比喻为货物购买：

我叫校园网，我有两重身份：ipv4和ipv6。
当我以ipv4的身份购买货物时，需要付费。
当我以ipv6的身份购买货物时，就不需要付费。
但是当我想以ipv6的身份去购买货物时，发现人们都不卖给我。
无奈，我只能使用ipv4的身份去付费购买货物。




3.代理

那么有没有一种方法，能保证只使用ipv6流量，并且也能访问ipv4的流量，使得网站和app能够正常使用呢？

答案当然是有的，它就是我们ipv6免流原理的核心——代理。

我们只需要找这么一位也同时具有ipv4和ipv6身份的，并且能够接受我们ipv6流量的代理人。

当我们想以ipv6的身份购买某件货物时，可以先以ipv6的身份将请求发送给代理人，代理人接收到请求后，会用自己的ipv4身份去购买这件货物，再将购买的货物，以ipv6的身份发送给我们。
（ipv4和ipv6不直接兼容，无法直接建立通信，故我们发送给代理人的请求，代理人只能通过ipv6接收。同理，代理人发送给我们的货物，我们也只能通过ipv6接收。这保证了我们与代理人之间的通信只依靠ipv6，是很关键的一点。）

如此，我们便全程以ipv6的身份，获取了这件仅ipv4身份才能才可以获得的货物。换句话说，我们只通过ipv6，访问并获取了ipv4的资源，与此同时，我们只使用了自身（校园网）的ipv6流量，没有使用ipv4流量。于是乎就不会造成计费。

当然，仅有这位代理人是不够的，想要实现真正意义上的免流，必须满足两个条件：
①我们与代理人之间的通信只依靠ipv6
②我们所有与外界的通信都会经过代理人，不会与外界建立直接通信而消耗ipv4流量。

条件①我刚刚讲过了，不再重复。
条件②的实现方法，便是我们每次使用免流之前，必须打开的两个按钮之一——tun模式，其作用就是可以接管我们上网的所有流量，保证所有流量都会经过这位代理人。

这里的代理人，本人为了方便管理、限制使用人等等，用的是国内外的云服务器。如果只是为了自己使用，也可以有其他选择，如warp、cloudflare cdn、鸡c、家庭宽带等等，或许有更简单的使用方法、更好的使用体验。

以上便是ipv6免流的全部过程，不难看出，ipv6免流虽然不会消耗自己的校园网计费流量，但其同样使用的是校园网，依旧会占用学校的带宽资源，同时也会消耗服务器的流量。所以还请各位取之有度、用之有节，不要滥用。
